<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>مؤسسة التميز الفاخر</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.plot.ly/plotly-2.32.0.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Calm Harmony (Warm Neutrals with Muted Blue Accent) -->
    <!-- Application Structure Plan: A multi-step wizard guides the user through filling out the contract. The left panel contains input forms for each section (Parties, Details, Clauses), while a right panel provides a real-time preview of the final document. This structure turns a static template into an interactive tool, making it easy for non-legal users to generate a complete contract. The final step allows for review and export (print/copy). This is the most logical interactive interpretation of a legal contract source. -->
    <!-- Visualization & Content Choices: Report Info: Contract Placeholders -> Goal: Guide user input -> Presentation: HTML Form Inputs -> Interaction: Real-time updates to a preview pane via JS. Report Info: Contract Clauses -> Goal: Inform user -> Presentation: Styled text blocks. Report Info: Conditional clauses (e.g., payment) -> Goal: Allow user choice -> Presentation: Radio buttons -> Interaction: JS toggles visibility of related inputs. This approach avoids inappropriate charts and focuses on creating a functional, interactive form-based application. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Cairo', sans-serif;
        }

        .step-indicator.active {
            background-color: #2563eb;
            color: white;
            border-color: #2563eb;
        }

        .step-indicator {
            border: 2px solid #d1d5db;
            color: #6b7280;
        }

        .form-section {
            display: none;
        }

        .form-section.active {
            display: block;
        }

        .preview-placeholder {
            color: #ef4444;
            font-weight: 600;
            background-color: #fee2e2;
            padding: 2px 6px;
            border-radius: 4px;
        }

        .handwriting-space {
            display: inline-block;
            border-bottom: 1px solid #9ca3af;
            min-width: 150px;
            height: 22px;
            vertical-align: bottom;
            margin: 0 3px;
        }

        .seal-space {
            width: 90px;
            height: 90px;
            border: 2px dashed #d1d5db;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        #fridge-image-preview-container,
        #image-container-preview {
            display: none;
            /* Hide image containers by default */
        }

        #fridge-image-preview,
        #preview-fridge-image {
            max-width: 100%;
            max-height: 200px;
            /* <-- يمكنك تعديل هذا الرقم للتحكم في حجم الصورة المعروضة على الشاشة */
            border-radius: 0.5rem;
            border: 1px solid #e5e7eb;
            margin-top: 1rem;
            object-fit: cover;
        }


        @media print {
            body.printing-blank-page .container {
                display: none;
            }

            body:not(.printing-blank-page) #blank-print-area {
                display: none;
            }

            body.printing-blank-page #blank-print-area {
                display: block;
                visibility: visible;
                position: absolute;
                top: 2rem;
                left: 2rem;
                right: 2rem;
            }

            body:not(.printing-blank-page) * {
                visibility: hidden;
            }

            body:not(.printing-blank-page) #print-area,
            body:not(.printing-blank-page) #print-area * {
                visibility: visible;
            }

            body:not(.printing-blank-page) #print-area {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
            }

            .preview-placeholder {
                color: #000 !important;
                background-color: transparent !important;
                font-weight: normal;
                padding: 0;
                border-radius: 0;
            }

            .preview-placeholder.is-empty {
                display: inline-block;
                min-width: 150px;
                border-bottom: 1px solid #000;
                height: 22px;
                vertical-align: bottom;
                color: transparent !important;
            }

            .handwriting-space {
                border-color: #000;
            }

            .seal-space {
                border-color: #000 !important;
            }

            .seal-space span {
                color: #ccc !important;
                /* Lighter placeholder text on print */
            }

            #preview-fridge-image {
                border-color: #000 !important;
                max-height: 160px;
                /* <-- يمكنك تعديل هذا الرقم للتحكم في حجم الصورة عند الطباعة */
            }

            .break-before-page {
                break-before: page;
                page-break-before: always;
                /* دعم أوسع */
            }
        }
    </style>
</head>

<body class="bg-slate-50 text-slate-800">

    <div class="container mx-auto p-4 md:p-8">
        <header class="text-center mb-8">
            <h1 class="text-3xl md:text-4xl font-bold text-slate-900">عقد تسليم واستلام ثلاجة</h1>
            <p class="mt-2 text-lg text-slate-600">أداة تفاعلية لإنشاء عقدك في خطوات بسيطة.</p>
        </header>

        <div class="lg:grid lg:grid-cols-12 lg:gap-8">

            <aside class="lg:col-span-4 xl:col-span-3 mb-8 lg:mb-0">
                <div class="bg-white p-6 rounded-xl shadow-lg sticky top-8">
                    <h2 class="text-xl font-bold mb-4">خطوات العقد</h2>
                    <div id="step-indicators" class="space-y-3">
                        <div id="step-1-indicator"
                            class="step-indicator active flex items-center p-3 rounded-lg transition-all duration-300">
                            <span
                                class="flex-shrink-0 w-8 h-8 rounded-full bg-inherit border-inherit flex items-center justify-center font-bold">1</span>
                            <span class="ms-3 font-semibold">بيانات الأطراف</span>
                        </div>
                        <div id="step-2-indicator"
                            class="step-indicator flex items-center p-3 rounded-lg transition-all duration-300">
                            <span
                                class="flex-shrink-0 w-8 h-8 rounded-full bg-inherit border-inherit flex items-center justify-center font-bold">2</span>
                            <span class="ms-3 font-semibold">تفاصيل العقد</span>
                        </div>
                        <div id="step-3-indicator"
                            class="step-indicator flex items-center p-3 rounded-lg transition-all duration-300">
                            <span
                                class="flex-shrink-0 w-8 h-8 rounded-full bg-inherit border-inherit flex items-center justify-center font-bold">3</span>
                            <span class="ms-3 font-semibold">المراجعة النهائية</span>
                        </div>
                    </div>
                </div>
            </aside>

            <main class="lg:col-span-8 xl:col-span-9">
                <div class="bg-white p-6 sm:p-8 rounded-xl shadow-lg">

                    <div id="form-container">
                        <!-- Step 1: Parties Information -->
                        <section id="step-1" class="form-section active">
                            <h3 class="text-2xl font-bold mb-6 border-b pb-3">الخطوة 1: بيانات أطراف العقد</h3>
                            <div class="space-y-6">
                                <div class="p-4 border rounded-lg bg-slate-50">
                                    <h4 class="text-lg font-semibold mb-2 text-blue-700">الطرف الأول (المالك)</h4>
                                    <div class="space-y-2 text-gray-800">
                                        <p><strong>الشركة: </strong> مؤسسة التميز الفاخر</p>
                                        <p><strong>يمثله في العقد: </strong> محمد رشاد مصطفى | مندوب مبيعات</p>
                                        <p><strong>رقم الإقامة: </strong> 2588078234</p>
                                        <p><strong>رقم السجل: </strong> 7032735172</p>
                                    </div>
                                </div>
                                <div class="p-4 border rounded-lg">
                                    <h4 class="text-lg font-semibold mb-2 text-blue-700">الطرف الثاني (المستلم)</h4>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div>
                                            <label for="party2-name" class="block mb-1 font-medium">اسم التاجر: </label>
                                            <input type="text" id="party2-name"
                                                class="w-full p-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                                placeholder="اكتب اسم البقالة أو الشخص المستلم">
                                        </div>
                                        <div>
                                            <label for="party2-cr" class="block mb-1 font-medium">رقم السجل
                                                التجاري:</label>
                                            <input type="text" id="party2-cr"
                                                class="w-full p-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                                placeholder="اكتب رقم السجل التجاري">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </section>

                        <!-- Step 2: Contract Details -->
                        <section id="step-2" class="form-section">
                            <h3 class="text-2xl font-bold mb-6 border-b pb-3">الخطوة 2: تفاصيل الثلاجة والعقد</h3>
                            <div class="space-y-6">
                                <div class="p-4 border rounded-lg">
                                    <h4 class="text-lg font-semibold mb-4 text-blue-700">مواصفات الثلاجة</h4>
                                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                        <div><label for="fridge-brand"
                                                class="block mb-1 font-medium">الماركة:</label><input type="text"
                                                id="fridge-brand" class="w-full p-2 border rounded-md"
                                                placeholder="دانسات"></div>
                                        <div><label for="fridge-model"
                                                class="block mb-1 font-medium">الموديل:</label><input type="text"
                                                id="fridge-model" class="w-full p-2 border rounded-md"
                                                placeholder="DGF-250"></div>
                                        <div><label for="fridge-doors" class="block mb-1 font-medium">عدد
                                                الأبواب:</label><input type="text" id="fridge-doors"
                                                class="w-full p-2 border rounded-md" placeholder="1"></div>
                                        <div><label for="fridge-shelves" class="block mb-1 font-medium">عدد
                                                الرفوف:</label><input type="text" id="fridge-shelves"
                                                class="w-full p-2 border rounded-md" placeholder="4"></div>
                                        <div><label for="fridge-height"
                                                class="block mb-1 font-medium">الارتفاع:</label><input type="text"
                                                id="fridge-height" class="w-full p-2 border rounded-md"
                                                placeholder="180 سم"></div>
                                        <div><label for="fridge-width"
                                                class="block mb-1 font-medium">العرض:</label><input type="text"
                                                id="fridge-width" class="w-full p-2 border rounded-md"
                                                placeholder="70 سم"></div>
                                        <div><label for="fridge-color"
                                                class="block mb-1 font-medium">اللون:</label><input type="text"
                                                id="fridge-color" class="w-full p-2 border rounded-md"
                                                placeholder="أبيض"></div>
                                        <div>
                                            <label for="fridge-condition" class="block mb-1 font-medium">حالة
                                                الثلاجة:</label>
                                            <select id="fridge-condition"
                                                class="w-full p-2 border rounded-md bg-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                                <option value="جديدة">جديدة</option>
                                                <option value="مستعملة">مستعملة</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="mt-4">
                                        <label for="fridge-general-desc" class="block mb-1 font-medium">وصف عام
                                            (اختياري):</label>
                                        <textarea id="fridge-general-desc" rows="3" class="w-full p-2 border rounded-md"
                                            placeholder="أي تفاصيل إضافية مثل الرقم التسلسلي أو حالة الثلاجة..."></textarea>
                                    </div>
                                </div>
                                <div class="p-4 border rounded-lg">
                                    <h4 class="text-lg font-semibold mb-2 text-blue-700">صورة الثلاجة</h4>
                                    <label for="fridge-image-input" class="block mb-2 font-medium">اختر صورة للثلاجة
                                        ليتم إدراجها في العقد:</label>
                                    <input type="file" id="fridge-image-input" accept="image/*"
                                        class="block w-full text-sm text-slate-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100">
                                    <div id="fridge-image-preview-container">
                                        <button id="remove-fridge-image-btn"
                                            class="mt-2 px-3 py-1 bg-red-100 text-red-700 text-sm font-semibold rounded-full hover:bg-red-200"
                                            style="display: none;">
                                            إزالة الصورة
                                        </button>
                                        <img id="fridge-image-preview" src="#" alt="معاينة الصورة" />
                                    </div>
                                </div>
                                <div class="p-4 border rounded-lg">
                                    <h4 class="text-lg font-semibold mb-2 text-blue-700">مكان التسليم</h4>
                                    <div>
                                        <label for="delivery-location" class="block mb-1 font-medium">عنوان تسليم
                                            الثلاجة:</label>
                                        <input type="text" id="delivery-location"
                                            class="w-full p-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                            placeholder="اكتب عنوان المحل أو المستودع الذي ستوضع فيه الثلاجة">
                                    </div>
                                </div>
                                <div class="p-4 border rounded-lg">
                                    <h4 class="text-lg font-semibold mb-2 text-blue-700">شروط العقد</h4>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div>
                                            <label for="contract-duration" class="block mb-1 font-medium">مدة
                                                العقد:</label>
                                            <input type="text" id="contract-duration"
                                                class="w-full p-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                                placeholder="سنة واحدة">
                                        </div>
                                        <div>
                                            <label for="notice-period" class="block mb-1 font-medium">مدة الإخطار بعدم
                                                التجديد:</label>
                                            <input type="text" id="notice-period"
                                                class="w-full p-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                                placeholder="شهر واحد">
                                        </div>
                                        <div>
                                            <label for="termination-notice" class="block mb-1 font-medium">مدة الإخطار
                                                بالفسخ:</label>
                                            <input type="text" id="termination-notice"
                                                class="w-full p-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                                placeholder="أسبوعين">
                                        </div>
                                        <div>
                                            <label for="dispute-location" class="block mb-1 font-medium">المحاكم المختصة
                                                في:</label>
                                            <input type="text" id="dispute-location"
                                                class="w-full p-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                                placeholder="اكتب اسم المدينة أو الدولة">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </section>

                        <!-- Step 3: Final Review -->
                        <section id="step-3" class="form-section">
                            <h3 class="text-2xl font-bold mb-6 border-b pb-3">الخطوة 3: المراجعة النهائية والتصدير</h3>
                            <p class="mb-4 text-slate-600">يرجى مراجعة نص العقد أدناه. الحقول الفارغة تظهر كنص أحمر
                                إرشادي، وعند الطباعة ستتحول إلى مساحة فارغة للكتابة اليدوية.</p>
                            <div id="print-area" class="bg-slate-50 p-6 rounded-lg border leading-loose">
                                <h4 class="text-xl font-bold text-center mb-4">عقد تسليم واستلام ثلاجة عرض</h4>
                                <p class="mb-4 text-center">
                                    <strong>إنه في يوم <span id="preview-date"
                                            data-placeholder="[تاريخ اليوم]"></span></strong>
                                </p>
                                <p class="mb-2"><strong>تم تحرير هذا العقد بين كل من:</strong></p>
                                <p>
                                    <strong>الطرف الأول:</strong> مؤسسة التميز الفاخر، ويمثله في هذا العقد: محمد رشاد
                                    مصطفى | مندوب مبيعات، رقم الإقامة: 2588078234، رقم السجل: 7032735172. (يشار إليه
                                    فيما بعد بـ "الطرف الأول")
                                </p>
                                <p class="mb-4">
                                    <strong>الطرف الثاني:</strong> <span id="preview-party2-name"
                                        data-placeholder="[اسم المستلم]"></span>، ورقم السجل: <span
                                        id="preview-party2-cr" data-placeholder="[رقم السجل]"></span>. (يشار إليه فيما
                                    بعد بـ "الطرف الثاني")
                                </p>
                                <h5 class="font-bold mt-4">مقدمة:</h5>
                                <p>حيث أن الطرف الأول يمتلك ثلاجة عرض بالمواصفات التالية:
                                    <strong>ماركة:</strong> <span id="preview-fridge-brand"
                                        data-placeholder="[الماركة]"></span>,
                                    <strong>موديل:</strong> <span id="preview-fridge-model"
                                        data-placeholder="[الموديل]"></span>,
                                    <strong>عدد الأبواب:</strong> <span id="preview-fridge-doors"
                                        data-placeholder="[عدد الأبواب]"></span>,
                                    <strong>عدد الرفوف:</strong> <span id="preview-fridge-shelves"
                                        data-placeholder="[عدد الرفوف]"></span>,
                                    <strong>اللون:</strong> <span id="preview-fridge-color"
                                        data-placeholder="[اللون]"></span>,
                                    <strong>الأبعاد:</strong> ارتفاع <span id="preview-fridge-height"
                                        data-placeholder="[الارتفاع]"></span> سم وعرض <span id="preview-fridge-width"
                                        data-placeholder="[العرض]"></span><span> سم</span>.
                                    <span id="preview-fridge-general-desc-container" style="display: none;"><strong>وصف
                                            إضافي:</strong> <span id="preview-fridge-general-desc"></span>.</span>
                                    وحيث أن الطرف الثاني يرغب في استلام
                                    هذه الثلاجة لاستخدامها في نشاطه التجاري، فقد اتفق الطرفان وهما بكامل
                                    أهليتهما المعتبرة شرعاً وقانوناً على ما يلي:
                                </p>

                                <h5 class="font-bold mt-4">البند الأول: موضوع العقد</h5>
                                <p>يعتبر التمهيد والمقدمة أعلاه جزءاً لا يتجزأ من هذا العقد. بموجب هذا العقد، يتعهد
                                    الطرف الأول بتسليم الثلاجة المذكورة في المقدمة إلى الطرف الثاني، ويتعهد الطرف الثاني
                                    باستلامها والاحتفاظ بها واستخدامها للغرض المخصص لها وفقاً للشروط والأحكام الواردة في
                                    هذا العقد.</p>

                                <h5 class="font-bold mt-4">البند الثاني: وصف وحالة الثلاجة</h5>
                                <p id="preview-clause-2"></p>
                                <div id="image-container-preview" class="mt-4">
                                    <h6 class="font-bold">صورة الثلاجة وقت التسليم:</h6>
                                    <img id="preview-fridge-image" src="#" alt="صورة الثلاجة" />
                                </div>


                                <h5 class="font-bold mt-4">البند الثالث: مكان التسليم والاستلام</h5>
                                <p id="preview-delivery-clause"></p>

                                <h5 class="font-bold mt-4">البند الرابع: مدة العقد</h5>
                                <p>تبدأ مدة هذا العقد من تاريخ التوقيع عليه وتستمر لمدة <span
                                        id="preview-contract-duration" data-placeholder="[مدة العقد]"></span>، قابلة
                                    للتجديد لمدة أو لمدد أخرى مماثلة ما لم يخطر أحد الطرفين الآخر كتابياً برغبته في عدم
                                    التجديد قبل <span id="preview-notice-period"
                                        data-placeholder="[مدة الإخطار]"></span> من تاريخ انتهاء العقد.</p>

                                <h5 class="font-bold mt-4">البند الخامس: التزامات الطرف الأول</h5>
                                <ol class="list-decimal list-inside space-y-1">
                                    <li>تسليم الثلاجة للطرف الثاني في التاريخ والمكان المتفق عليهما، بالحالة الجيدة
                                        والصالحة للاستعمال.</li>
                                    <li>توفير أي قطع غيار أو صيانة ضرورية للثلاجة خلال فترة الضمان (إن وجدت وكانت مشمولة
                                        بالاتفاق).</li>
                                    <li>إعلام الطرف الثاني بأي عيوب أو مشاكل في الثلاجة قبل التسليم إن وجدت.</li>
                                </ol>

                                <h5 class="font-bold mt-4">البند السادس: التزامات الطرف الثاني</h5>
                                <ol class="list-decimal list-inside space-y-1">
                                    <li>استلام الثلاجة في المكان والزمان المحددين.</li>
                                    <li>المحافظة على الثلاجة واستخدامها بشكل سليم وفقاً لتعليمات الاستخدام المتعارف
                                        عليها.</li>
                                    <li>إجراء الصيانة الدورية للثلاجة حسب تعليمات الشركة المصنعة.</li>
                                    <li>إبلاغ الطرف الأول فوراً بأي عيوب أو مشاكل جوهرية تطرأ على الثلاجة.</li>
                                    <li>عدم التنازل عن الثلاجة للغير أو نقلها من الموقع المتفق عليه دون الحصول على
                                        موافقة خطية مسبقة من الطرف الأول.</li>
                                    <li>يتحمل الطرف الثاني المسؤولية الكاملة عن أي تلف أو فقدان للثلاجة يحدث نتيجة
                                        إهماله أو سوء استخدامه، ويلتزم في هذه الحالة بدفع قيمتها السوقية للطرف الأول وقت
                                        حدوث الضرر.</li>
                                </ol>

                                <h5 class="font-bold mt-4">البند السابع: المقابل المالي</h5>
                                <p>تم تسليم الثلاجة للطرف الثاني على سبيل الأمانة وبدون مقابل مالي، ويلتزم
                                    باستخدامها في عرض منتجات الطرف الأول فقط.</p>

                                <h5 class="font-bold mt-4">البند الثامن: فسخ العقد</h5>
                                <p>يجوز لأي من الطرفين فسخ هذا العقد في حال إخلال الطرف الآخر بأي من بنوده الجوهرية، مع
                                    إخطار الطرف المخل كتابياً ومنحه مهلة قدرها <span id="preview-termination-notice"
                                        data-placeholder="[مدة الإخطار بالفسخ]"></span> لتصحيح المخالفة. فإن لم يقم
                                    بذلك، يعتبر العقد مفسوخاً.</p>

                                <h5 class="font-bold mt-4 break-before-page" id="clause-9-title">البند التاسع: حل
                                    النزاعات</h5>
                                <p>في حال وجود أي نزاع حول هذا العقد، يتم تسويته أولاً بالطرق الودية. وإذا تعذر ذلك، يتم
                                    اللجوء إلى المحاكم المختصة في <span id="preview-dispute-location"
                                        data-placeholder="[مكان المحاكم]"></span> للفصل في النزاع.</p>

                                <h5 class="font-bold mt-4">البند العاشر: الأحكام العامة</h5>
                                <ol class="list-decimal list-inside space-y-1">
                                    <li>يعتبر هذا العقد بمثابة الاتفاق الكامل والنهائي بين الطرفين.</li>
                                    <li>لا يجوز تعديل أو إلغاء هذا العقد أو أي من بنوده إلا بموافقة خطية من الطرفين.
                                    </li>
                                    <li>تعتبر جميع المراسلات والتبليغات بين الطرفين على العناوين الموضحة بصدر هذا العقد
                                        منتجة لآثارها القانونية.</li>
                                    <li>حُرر هذا العقد من نسختين، بيد كل طرف نسخة للعمل بموجبها.</li>
                                </ol>

                                <h5 class="font-bold mt-6">وعلى ما تقدم، تم التوقيع.</h5>
                                <div class="mt-8 grid grid-cols-2 gap-8 text-center">
                                    <div>
                                        <p><strong>الطرف الأول</strong></p>
                                        <p>الاسم: محمد رشاد مصطفى</p>
                                        <p class="mt-8">التوقيع: ___________________</p>
                                    </div>
                                    <div>
                                        <p><strong>الطرف الثاني</strong></p>
                                        <p>الاسم: <span id="preview-signature-party2"
                                                data-placeholder="[اسم المستلم]"></span></p>
                                        <p class="mt-8">التوقيع: ___________________</p>
                                        <div class="seal-space mt-6 mx-auto">
                                            <span class="text-sm text-slate-500">ختم المؤسسة</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="mt-8 flex items-center justify-center gap-4">
                                <button onclick="window.print()"
                                    class="px-6 py-2 bg-green-600 text-white font-semibold rounded-lg hover:bg-green-700 transition-colors">طباعة
                                    العقد</button>
                                <button id="copy-btn"
                                    class="px-6 py-2 bg-sky-600 text-white font-semibold rounded-lg hover:bg-sky-700 transition-colors">نسخ
                                    النص</button>
                            </div>
                            <div id="copy-feedback" class="text-center mt-4 text-green-600 font-semibold"
                                style="display: none;">تم نسخ النص بنجاح!</div>
                        </section>
                    </div>

                    <!-- Navigation Buttons -->
                    <div class="mt-8 pt-6 border-t flex justify-between">
                        <button id="prev-btn"
                            class="px-6 py-2 bg-slate-200 text-slate-700 font-semibold rounded-lg hover:bg-slate-300 transition-colors"
                            style="display: none;">السابق</button>
                        <button id="next-btn"
                            class="px-6 py-2 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 transition-colors ms-auto">التالي</button>
                    </div>

                </div>
            </main>
        </div>
    </div>

    <!-- Blank Template for Printing -->
    <div id="blank-print-area" class="p-8 leading-loose" style="display: none;">
        <h1 class="text-2xl font-bold text-center mb-12">عقد تسليم واستلام</h1>
        <div class="space-y-8">
            <div>
                <h2 class="text-xl font-bold border-b-2 border-black pb-2 mb-4">الطرف الأول</h2>
                <p class="mb-4"><strong>الشركة / الاسم:</strong></p>
                <p class="mb-4"><strong>رقم السجل / الإقامة:</strong></p>
                <p class="mb-4"><strong>العنوان:</strong></p>
            </div>
            <div>
                <h2 class="text-xl font-bold border-b-2 border-black pb-2 mb-4">الطرف الثاني</h2>
                <p class="mb-4"><strong>الشركة / الاسم:</strong></p>
                <p class="mb-4"><strong>رقم السجل / الإقامة:</strong></p>
                <p class="mb-4"><strong>العنوان:</strong></p>
            </div>
            <div>
                <h2 class="text-xl font-bold border-b-2 border-black pb-2 mb-4">تفاصيل التسليم</h2>
                <div style="height: 200px; border: 1px solid #ccc; margin-top: 1rem;"></div>
            </div>
            <div class="mt-24 grid grid-cols-2 gap-16 text-center">
                <div>
                    <p><strong>توقيع الطرف الأول</strong></p>
                    <p class="mt-16 border-t-2 border-black pt-2">الاسم:</p>
                </div>
                <div>
                    <p><strong>توقيع الطرف الثاني</strong></p>
                    <p class="mt-16 border-t-2 border-black pt-2">الاسم:</p>
                </div>
            </div>
        </div>
    </div>


    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const steps = [1, 2, 3];
            let currentStep = 1;

            const prevBtn = document.getElementById('prev-btn');
            const nextBtn = document.getElementById('next-btn');
            const printBlankBtn = document.getElementById('print-blank-btn');

            const fieldMapping = {
                'party2-name': ['preview-party2-name', 'preview-signature-party2'],
                'party2-cr': ['preview-party2-cr'],
                'fridge-brand': ['preview-fridge-brand'],
                'fridge-model': ['preview-fridge-model'],
                'fridge-doors': ['preview-fridge-doors'],
                'fridge-shelves': ['preview-fridge-shelves'],
                'fridge-height': ['preview-fridge-height'],
                'fridge-width': ['preview-fridge-width'],
                'fridge-color': ['preview-fridge-color'],
                'fridge-general-desc': ['preview-fridge-general-desc'],
                'contract-duration': ['preview-contract-duration'],
                'notice-period': ['preview-notice-period'],
                'termination-notice': ['preview-termination-notice'],
                'dispute-location': ['preview-dispute-location'],
            };
            const fridgeImageInput = document.getElementById('fridge-image-input');
            const removeFridgeImageBtn = document.getElementById('remove-fridge-image-btn');

            function applyPlaceholderStyle(element, value) {
                const placeholder = element.dataset.placeholder;
                element.textContent = value || placeholder;
                element.classList.add('preview-placeholder');
                if (value) {
                    element.classList.remove('is-empty');
                } else {
                    element.classList.add('is-empty');
                }
            }

            function updatePreview(inputId, value) {
                if (fieldMapping[inputId]) {
                    fieldMapping[inputId].forEach(previewId => {
                        const el = document.getElementById(previewId);
                        if (el) applyPlaceholderStyle(el, value);
                    });
                }
                // Special handling for optional general description
                if (inputId === 'fridge-general-desc') {
                    const container = document.getElementById('preview-fridge-general-desc-container');
                    if (container) {
                        container.style.display = value ? 'block' : 'none';
                    }
                }
            }

            function updateDeliveryClause() {
                const deliveryLocationValue = document.getElementById('delivery-location').value;
                const party2CrValue = document.getElementById('party2-cr').value;
                const clauseElement = document.getElementById('preview-delivery-clause');

                clauseElement.innerHTML = ''; // Clear previous content

                if (deliveryLocationValue) {
                    const locationSpan = document.createElement('span');
                    locationSpan.dataset.placeholder = '[عنوان التسليم]';
                    applyPlaceholderStyle(locationSpan, deliveryLocationValue);
                    clauseElement.innerHTML = `يتم تسليم واستلام الثلاجة في مقر عمل الطرف الثاني الكائن في: ${locationSpan.outerHTML}.`;
                } else {
                    const crSpan = document.createElement('span');
                    crSpan.dataset.placeholder = '[رقم السجل]';
                    applyPlaceholderStyle(crSpan, party2CrValue);
                    clauseElement.innerHTML = `يتم تسليم واستلام الثلاجة في مقر الطرف الثاني المسجل لديه بموجب السجل التجاري رقم: ${crSpan.outerHTML}.`;
                }
            }

            function updateClause2() {
                const conditionValue = document.getElementById('fridge-condition').value;
                const clauseElement = document.getElementById('preview-clause-2');
                if (!clauseElement) return;

                const conditionSpan = document.createElement('span');
                conditionSpan.dataset.placeholder = '[الحالة]';
                applyPlaceholderStyle(conditionSpan, conditionValue);

                let text;
                if (conditionValue === 'جديدة') {
                    text = `يُقر الطرف الثاني بأنه عاين الثلاجة المعاينة التامة النافية للجهالة، ويقر بأنها تُسلم وهي بحالة ${conditionSpan.outerHTML} وغير مستعملة سابقاً، وصالحة للاستعمال وتفي بالغرض الذي استلمها من أجله.`;
                } else if (conditionValue === 'مستعملة') {
                    text = `يُقر الطرف الثاني بأنه عاين الثلاجة المعاينة التامة النافية للجهالة، ويقر بأنها ${conditionSpan.outerHTML} بحالة جيدة ، وأنها صالحة للاستعمال وتفي بالغرض الذي استلمها من أجله.`;
                } else {
                    text = `يُقر الطرف الثاني بأنه عاين الثلاجة المعاينة التامة النافية للجهالة، ويقر بأنها تُسلم وهي بحالة ${conditionSpan.outerHTML} وصالحة للاستعمال وتفي بالغرض الذي استلمها من أجله.`;
                }
                clauseElement.innerHTML = text;
            }

            function navigate(step) {
                currentStep = step;
                document.querySelectorAll('.form-section').forEach(s => s.classList.remove('active'));
                document.getElementById(`step-${currentStep}`).classList.add('active');
                document.querySelectorAll('.step-indicator').forEach(i => i.classList.remove('active'));
                document.getElementById(`step-${currentStep}-indicator`).classList.add('active');
                prevBtn.style.display = currentStep > 1 ? 'inline-block' : 'none';
                nextBtn.style.display = currentStep < steps.length ? 'inline-block' : 'none';
            }

            nextBtn.addEventListener('click', () => navigate(currentStep + 1));
            prevBtn.addEventListener('click', () => navigate(currentStep - 1));

            const today = new Date();
            const dateString = new Intl.DateTimeFormat('ar-EG-u-nu-latn', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' }).format(today);
            const dateEl = document.getElementById('preview-date');
            dateEl.textContent = dateString;
            dateEl.classList.add('preview-placeholder');

            Object.keys(fieldMapping).forEach(inputId => {
                const inputEl = document.getElementById(inputId);
                if (inputEl) {
                    const eventType = inputEl.tagName.toLowerCase() === 'select' ? 'change' : 'input';
                    inputEl.addEventListener(eventType, (e) => updatePreview(inputId, e.target.value));
                    updatePreview(inputId, inputEl.value || ''); // Initialize view with current value
                }
            });

            document.getElementById('delivery-location').addEventListener('input', updateDeliveryClause);
            document.getElementById('party2-cr').addEventListener('input', updateDeliveryClause);
            document.getElementById('fridge-condition').addEventListener('change', updateClause2);

            updateDeliveryClause();
            updateClause2();

            fridgeImageInput.addEventListener('change', function (event) {
                const file = event.target.files[0];
                if (file) {
                    const fridgeImagePreview = document.getElementById('fridge-image-preview');
                    const fridgeImagePreviewContainer = document.getElementById('fridge-image-preview-container');
                    const previewFridgeImage = document.getElementById('preview-fridge-image');
                    const imageContainerPreview = document.getElementById('image-container-preview');

                    const reader = new FileReader();
                    reader.onload = function (e) {
                        fridgeImagePreview.src = e.target.result;
                        fridgeImagePreviewContainer.style.display = 'block';
                        removeFridgeImageBtn.style.display = 'inline-block';

                        previewFridgeImage.src = e.target.result;
                        imageContainerPreview.style.display = 'block';
                    }
                    reader.readAsDataURL(file);
                }
            });

            removeFridgeImageBtn.addEventListener('click', () => {
                fridgeImageInput.value = ''; // Clear the file input
                document.getElementById('fridge-image-preview').src = '#';
                document.getElementById('preview-fridge-image').src = '#';
                document.getElementById('fridge-image-preview-container').style.display = 'none';
                document.getElementById('image-container-preview').style.display = 'none';
                removeFridgeImageBtn.style.display = 'none';
            });


            const copyBtn = document.getElementById('copy-btn');
            const copyFeedback = document.getElementById('copy-feedback');
            copyBtn.addEventListener('click', () => {
                const contractText = document.getElementById('print-area').innerText;
                navigator.clipboard.writeText(contractText).then(() => {
                    copyFeedback.style.display = 'block';
                    setTimeout(() => { copyFeedback.style.display = 'none'; }, 2000);
                });
            });

            printBlankBtn.addEventListener('click', () => {
                document.body.classList.add('printing-blank-page');
                window.print();
            });

            window.onafterprint = () => {
                if (document.body.classList.contains('printing-blank-page')) {
                    document.body.classList.remove('printing-blank-page');
                }
            };

            navigate(1);
        });
    </script>
</body>

</html>